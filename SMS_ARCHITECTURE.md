```
SMS Integration Architecture
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Your Phone â”‚
â”‚     ğŸ“±      â”‚  Send: "What's my workout today?"
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Twilio Service                           â”‚
â”‚  â€¢ Receives SMS                                                 â”‚
â”‚  â€¢ Sends webhook POST to your server                            â”‚
â”‚  â€¢ Forwards response back to your phone                         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                              â”‚
       â”‚ HTTP POST                                    â”‚ SMS Response
       â”‚ /api/v1/sms/webhook                          â”‚
       â”‚                                              â”‚
       â–¼                                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   OpenPoke Backend (FastAPI)                    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  SMS Routes (/server/routes/sms.py)                        â”‚ â”‚
â”‚  â”‚  â€¢ GET  /status      - Check connection                    â”‚ â”‚
â”‚  â”‚  â€¢ POST /connect     - Setup credentials                   â”‚ â”‚
â”‚  â”‚  â€¢ POST /disconnect  - Remove credentials                  â”‚ â”‚
â”‚  â”‚  â€¢ POST /webhook     - Receive incoming SMS â—„â”€â”€â”€â”€â”         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                   â”‚                             â”‚
â”‚                                   â–¼                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  SMS Service (/server/services/sms/client.py)              â”‚ â”‚
â”‚  â”‚  â€¢ handle_incoming_sms()  - Process webhook                â”‚ â”‚
â”‚  â”‚  â€¢ send_sms()             - Send responses                 â”‚ â”‚
â”‚  â”‚  â€¢ connect/disconnect     - Credential management          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                   â”‚                             â”‚
â”‚                                   â–¼                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Interaction Agent Runtime                                 â”‚ â”‚
â”‚  â”‚  (/server/agents/interaction_agent/runtime.py)             â”‚ â”‚
â”‚  â”‚  â€¢ execute_sync() - Process message & return response      â”‚ â”‚
â”‚  â”‚  â€¢ Full agent capabilities (tools, memory, etc.)           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                   â”‚                             â”‚
â”‚                                   â–¼                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Tools & Execution Agents                                  â”‚ â”‚
â”‚  â”‚  â€¢ Gmail, Whoop, Hevy integrations                         â”‚ â”‚
â”‚  â”‚  â€¢ Web search, email processing, etc.                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  Response flows back up through:                                â”‚
â”‚  Runtime â†’ SMS Service â†’ Twilio â†’ Your Phone                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Configuration Flow
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Option 1: Environment Variables (.env file)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TWILIO_ACCOUNT_SID=ACxxxxxxxxxx                                â”‚
â”‚  TWILIO_AUTH_TOKEN=xxxxxxxxxx                                   â”‚
â”‚  TWILIO_PHONE_NUMBER=+1234567890                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
         Loaded by server/config.py
                    â–¼
              Used by SMS Service


Option 2: Web Interface
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Settings Modal (web/components/SettingsModal.tsx)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  SMS Text Messaging Section                                â”‚ â”‚
â”‚  â”‚  â€¢ Account SID input                                       â”‚ â”‚
â”‚  â”‚  â€¢ Auth Token input                                        â”‚ â”‚
â”‚  â”‚  â€¢ Phone Number input                                      â”‚ â”‚
â”‚  â”‚  â€¢ [Connect] button                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
         POST to /api/sms/connect
                    â–¼
         Saved to ~/.openpoke/sms_config.json


Message Flow Example
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. You: "What's my workout today?"
   â”‚
   â”œâ”€â–º Twilio receives SMS
   â”‚
   â”œâ”€â–º Webhook POST to /api/v1/sms/webhook
   â”‚   Body: { From: "+1234567890", Body: "What's my workout today?" }
   â”‚
   â”œâ”€â–º SMS Service calls Interaction Agent
   â”‚   runtime.execute_sync("What's my workout today?")
   â”‚
   â”œâ”€â–º Agent processes message:
   â”‚   â€¢ Checks conversation history
   â”‚   â€¢ Determines intent
   â”‚   â€¢ May call Hevy tool to fetch workouts
   â”‚   â€¢ Generates response
   â”‚
   â”œâ”€â–º Response: "Today's workout: Push day - Bench press, ..."
   â”‚
   â”œâ”€â–º SMS Service sends via Twilio API
   â”‚   send_sms(to="+1234567890", message="Today's workout...")
   â”‚
   â””â”€â–º You receive response on phone ğŸ“±


Local Development with ngrok
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Your Phone  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Twilio     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ HTTPS
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ngrok                                     â”‚
â”‚  https://abc123.ngrok.io â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚         â”‚                                 â”‚ â”‚
â”‚         â”‚ Forwards to                     â”‚ â”‚
â”‚         â–¼                                 â”‚ â”‚
â”‚  http://localhost:8001                    â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OpenPoke Backend                          â”‚
â”‚  â€¢ Receives at /api/v1/sms/webhook         â”‚
â”‚  â€¢ Processes message                       â”‚
â”‚  â€¢ Sends response via Twilio API           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


File Structure
â•â•â•â•â•â•â•â•â•â•â•â•â•â•

openpoke/
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ config.py                 # Twilio credentials config
â”‚   â”œâ”€â”€ requirements.txt          # Added: twilio>=8.0.0
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ __init__.py          # SMS router registered
â”‚   â”‚   â””â”€â”€ sms.py               # â­ SMS API endpoints
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ sms/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â””â”€â”€ client.py        # â­ Twilio integration
â”‚   â””â”€â”€ agents/
â”‚       â””â”€â”€ interaction_agent/
â”‚           â””â”€â”€ runtime.py       # Added: execute_sync()
â”‚
â”œâ”€â”€ web/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ SettingsModal.tsx    # â­ SMS UI section
â”‚   â””â”€â”€ app/api/sms/             # â­ Next.js API proxies
â”‚       â”œâ”€â”€ status/route.ts
â”‚       â”œâ”€â”€ connect/route.ts
â”‚       â””â”€â”€ disconnect/route.ts
â”‚
â”œâ”€â”€ .env                          # Twilio credentials
â”œâ”€â”€ .env.example                  # Updated with SMS vars
â”‚
â””â”€â”€ Documentation:
    â”œâ”€â”€ SMS_SETUP_GUIDE.md       # â­ Detailed setup
    â”œâ”€â”€ SMS_QUICKSTART.md        # â­ 5-min quick start
    â”œâ”€â”€ IMPLEMENTATION_SUMMARY.md # â­ This summary
    â””â”€â”€ DEVELOPMENT_GUIDE.md     # Updated with SMS

â­ = New or significantly modified for SMS integration
```
